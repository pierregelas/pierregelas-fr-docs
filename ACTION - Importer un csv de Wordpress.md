# Tableau 1 — Mapping YAML maître ↔ Source (WordPress CSV) + Règles

| **YAML maître**                                                                | **Correspondance mapping source (CSV WordPress)** | **Règles (calcul / dérivation / modif)**                                                                                                                                                     |
| ------------------------------------------------------------------------------ | ------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| cover                                                                          | wp_img_url                                        | Prendre la **1ʳᵉ URL** si `wp_img_url` contient `\|\|`, sinon copier tel quel. `trim`.                                                                                                       |
| IMAGES: ______________________________________________________________________ | *(ligne de section – émise telle quelle)*         | *(aucune)*                                                                                                                                                                                   |
| img_alt                                                                        | wp_img_alt                                        | Copier tel quel, `trim`. Si plusieurs valeurs séparées par `\|\|`, **convertir en liste YAML** (split) en `- item` avec `trim` de chaque élément.                                            |
| img_descr                                                                      | wp_img_descr                                      | Copier tel quel, `trim`. Si plusieurs valeurs séparées par `\|\|`, **convertir en liste YAML** (split) en `- item` avec `trim` de chaque élément.                                            |
| img_filename                                                                   | wp_img_filename                                   | Copier tel quel, `trim`. Si plusieurs valeurs séparées par `\|\|`, **convertir en liste YAML** (split) en `- item` avec `trim` de chaque élément.                                            |
| img_id                                                                         | wp_img_id                                         | Copier tel quel, `trim`. Si plusieurs valeurs séparées par `\|\|`, **convertir en liste YAML** (split) en `- item` avec `trim` de chaque élément.                                            |
| img_legende                                                                    | wp_img_caption                                    | Copier tel quel, `trim`. Si plusieurs valeurs séparées par `\|\|`, **convertir en liste YAML** (split) en `- item` avec `trim` de chaque élément.                                            |
| img_titre                                                                      | wp_img_titre                                      | Copier tel quel, `trim`. Si plusieurs valeurs séparées par `\|\|`, **convertir en liste YAML** (split) en `- item` avec `trim` de chaque élément.                                            |
| img_url                                                                        | wp_img_url                                        | Copier tel quel, `trim`. Si plusieurs valeurs séparées par `\|\|`, **convertir en liste YAML** (split) en `- item` avec `trim` de chaque élément.                                            |
| LIEN: ______________________________________________________________________   | *(ligne de section – émise telle quelle)*         | *(aucune)*                                                                                                                                                                                   |
| lien_archives                                                                  | *(aucune colonne correspondante dans l’export)*   | Laisser vide.                                                                                                                                                                                |
| lien_journal                                                                   | *(aucune colonne correspondante dans l’export)*   | Laisser vide.                                                                                                                                                                                |
| lien_projet                                                                    | wp_categories                                     | **Names hiérarchiques**: `split('>')` → `trim` → **dédupliquer (ordre conservé)** → transformer chaque segment en **"[[Name]]"** (casse/accents **conservés**). Si vide ⇒ `lien_projet: []`. |
| lien_restes                                                                    | *(aucune colonne correspondante dans l’export)*   | Laisser vide.                                                                                                                                                                                |
| MAJ: ______________________________________________________________________    | *(ligne de section – émise telle quelle)*         | *(aucune)*                                                                                                                                                                                   |
| maj_wp                                                                         | *(case à cocher calculée par l’action)*           | **Booléen**: `true` si la note a été **créée** ou **modifiée** durant l’import, sinon `false`.                                                                                               |
| POST: ______________________________________________________________________   | *(ligne de section – émise telle quelle)*         | *(aucune)*                                                                                                                                                                                   |
| post_cat                                                                       | wp_categories                                     | Convertir **names hiérarchiques** en **liste**: `split('>')` → `trim` → **dédupliquer (ordre conservé)**. (Option: slugifier si besoin d’IDs stables.)                                       |
| post_date                                                                      | wp_date                                           | Remplacer l'espace par `T` (ex.: `YYYY-MM-DD HH:MM:SS` → `YYYY-MM-DDTHH:MM:SS`). Si seule la date est fournie, **ajouter** `T00:00:00`.                                                      |
| post_descr                                                                     | wp_a_descr_gen                                    | Copier tel quel, `trim`.                                                                                                                                                                     |
| post_extrait                                                                   | wp_extrait                                        | Copier tel quel.                                                                                                                                                                             |
| post_id                                                                        | wp_id                                             | Copier tel quel (clé d’**idempotence**).                                                                                                                                                     |
| post_mod                                                                       | wp_date_modified                                  | Remplacer l'espace par `T` (ex.: `YYYY-MM-DD HH:MM:SS` → `YYYY-MM-DDTHH:MM:SS`). Si seule la date est fournie, **ajouter** `T00:00:00`.                                                      |
| post_perma                                                                     | wp_perma                                          | Copier tel quel (URL absolue).                                                                                                                                                               |
| post_titre_1                                                                   | wp_a_titre_gen                                    | Copier tel quel. **Fallback**: dériver depuis `wp_titre` par split sur —, – ou : (partie gauche).                                                                                            |
| post_titre_2                                                                   | wp_a_stitre_gen                                   | Copier tel quel. **Fallback**: dériver depuis `wp_titre` par split sur —, – ou : (partie droite).                                                                                            |
| post_titre_full                                                                | wp_titre                                          | **Égal à** `wp_titre` (copie stricte).                                                                                                                                                       |
| post_vid_url                                                                   | wp_a_videolink_gen                                | Copier tel quel si URL valide, sinon laisser vide.                                                                                                                                           |
| tags                                                                           | wp_tags                                           | **Séparer** sur `,` → `trim` → **slugify_wp** (minuscules, sans accents, espaces→`-`) → **dédupliquer** (ordre conservé) → **émettre en liste YAML** (`- item`).                             |
| WP: ______________________________________________________________________     | *(ligne de section – émise telle quelle)*         | *(aucune)*                                                                                                                                                                                   |
| wp_carnet_link                                                                 | wp_carnet_link                                    | Copier tel quel (URL ou vide).                                                                                                                                                               |
| wp_carnet_on                                                                   | wp_carnet_on                                      | **Booléen**: interpréter `1/0/true/false/oui/non` → ``true` / `false``. Défaut: `false`.                                                                                                     |
| wp_status                                                                      | wp_status                                         | Copier tel quel (`publish / pending / draft / …`)                                                                                                                                            |

## Règle — Peuplement de `lien_projet` depuis `wp_categories`

`lien_projet` est généré **directement** depuis `wp_categories` qui contient les **names** (pas les slugs) hiérarchisés par le caractère `>` : on split sur `>`, on trim les espaces, on ignore les segments vides, on **conserve casse et accents**, on **déduplique en gardant l’ordre**, puis on transforme chaque segment en wikilink au format **"[[Name]]"** (guillemets doubles inclus) pour produire la liste YAML ; si `wp_categories` est vide/absent ⇒ `lien_projet: []` (ex.: `Vidéo>Minutes` ⇒ `[[Vidéo]]`, `[[Minutes]]`).


## Note — `maj_wp` (case à cocher)
- Type: booléen (checkbox).
- Remplissage par l’action : `true` si la note a été **créée** ou **modifiée** pendant cet import, sinon `false`.
